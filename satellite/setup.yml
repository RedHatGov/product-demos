user_message:

controller_components:
  - inventory_sources
  - job_templates

controller_inventory_sources:
- name: Satellite Inventory
  inventory: Workshop Inventory
  credential: Inventory Credential
  source: satellite6
  update_on_launch: false
  overwrite: true
  source_vars:
    keyed_groups:
      - prefix: env
        key: foreman_content_facet_attributes.lifecycle_environment_name
      - prefix: cv
        key: foreman_content_facet_attributes.content_view_name
      - prefix: os
        key: foreman_operatingsystem_name

controller_templates:
- name: LINUX / Register with Satellite
  project: Ansible official demo project
  playbook: satellite/setup.yml
  inventory: Workshop Inventory
  credentials:
    - Workshop Credential
  extra_vars:
    org_id: "Default_Organization"
  survey_enabled: true
  survey:
    name: ''
    description: ''
    spec:
      - question_name: Server Name or Pattern
        type: text
        variable: HOSTS
        required: false
      - question_name: Choose Environment
        type: multiplechoice
        variable: env
        choices:
          - Dev
          - QA
          - Prod
        required: true

- name: LINUX / Compliance Scan with Satellite
  project: Ansible official demo project
  playbook: satellite/server_openscap.yml
  inventory: Workshop Inventory
  credentials:
    - Satellite Credential
    - Workshop Credential
  extra_vars:
    policy_scan: all
    survey_enabled: true
  survey:
    name: ''
    description: ''
    spec:
      - question_name: Server Name or Pattern
        type: text
        variable: HOSTS
        required: false

- name: SATELLITE / Publish Content View Version
  project: Ansible official demo project
  playbook: satellite/satellite_publish.yml
  inventory: Workshop Inventory
  credentials:
    - Satellite Credential
  extra_vars:
    env: Dev
  survey_enabled: true
  survey:
    name: ''
    description: ''
    spec:
      - question_name: Select Content View
        variable: content_view
        type: multiplechoice
        choices: "{{ hostvars['satellite.example.com']['satellite_content_views'] | selectattr('name', 'match', '^RHEL.*$') | map(attribute='name') | list}}"
        required: true

- name: SATELLITE / Promote Content View Version
  project: Ansible official demo project
  playbook: satellite/satellite_promote.yml
  inventory: Workshop Inventory
  credentials:
    - Satellite Credential
  survey_enabled: true
  survey:
    name: ''
    description: ''
    spec:
      - question_name: Select Content View
        variable: content_view
        type: multiplechoice
        choices: "{{ hostvars['satellite.example.com']['satellite_content_views'] | selectattr('name', 'match', '^RHEL.*$') | map(attribute='name') | list}}"
        required: true
      - question_name: Current Lifecycle Environment
        variable: current_lifecycle_environment
        type: multiplechoice
        choices: "{{ hostvars['satellite.example.com']['satellite_lifecycle_environments'] | selectattr('name', 'match', '^RHEL.*$') | map(attribute='name') | list}}"
        required: true
      - question_name: Next Lifecycle Environment
        variable: lifecycle_environment
        type: multiplechoice
        choices: "{{ hostvars['satellite.example.com']['satellite_lifecycle_environments'] | selectattr('name', 'match', '^RHEL.*$') | map(attribute='name') | list}}"
        required: true
